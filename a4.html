<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, maximum-scale=1.0" />

    <title>Anushka Sharma's HCDE 439 Physical Computing Page!</title>

    <link href="style.css" rel="stylesheet" type="text/css" />
  </head>
  <body>
    <h1>Anushka Sharma's Assignment 4!</h1>
    <div class="header">
      <img src="a4_circuit.jpg" />
      <p>Here is all the documentation for assignment 4!</p>
    </div>
    <!-- Schematic -->
    <section>
      <h2>Schematic</h2>
      <figure>
        <img src="a4_schematic.jpg"/>
        <figcaption>
          This schematic shows the Arduino Uno connected to an ultrasonic distance sensor (HC-SR04) using pins A0 and A1 
          for trigger and echo, and a 16x2 LCD display to visualize the measured distance.
        </figcaption>
      </figure>
    </section>

    <!-- Circuit on Breadboard -->
    <section>
      <h2>Circuit on Breadboard</h2>
      <figure>
        <img src="a4_circuit.jpg"/>
        <figcaption>
          The circuit diagram illustrates the connection between an Arduino Uno, an ultrasonic 
          distance sensor, and a 16x2 LCD display. The ultrasonic sensor sends and receives sound waves to measure distance, 
          while the LCD displays the measured values in real time.
        </figcaption>
      </figure>
    </section>

    <!-- Arduino Code -->
    <section>
      <h2>Arduino Code</h2>
      <pre><code>
        // Using the LiquidCrystal library to control the LCD
        #include <LiquidCrystal.h>

        // Defining the LCD pin connections (RS, EN, D4, D5, D6, D7)
        const int rs = 12, en = 11, d4 = 5, d5 = 4, d6 = 3, d7 = 2;
        // Creating an LCD object using the defined pins
        LiquidCrystal lcd(rs, en, d4, d5, d6, d7);

        // Defining the ultrasonic sensor pins
        // Trigger pin sends the sound pulse
        const int trigPin = A0; 
        // Echo pin receives the reflected pulse 
        const int echoPin = A1;  

        void setup() {
        // Initializing the LCD with 16 columns and 2 rows
        lcd.begin(16, 2); 
        // Displaying a startup message
        lcd.print("Sonar Sensor");
        // Waiting for 1 second before continuing (to prevent screen flicker)
        delay(1000);
        // Clearing the LCD screen before displaying new data
        lcd.clear();

        // Setting the ultrasonic sensor pins as output (trigger) and input (echo)
        pinMode(trigPin, OUTPUT);
        pinMode(echoPin, INPUT);
        }

        void loop() {
        // Variables to store the duration of the echo pulse and calculated distance
        long duration;
        int distance;
        // Sending an initial short LOW pulse for a clean HIGH signal later
        digitalWrite(trigPin, LOW);
        delayMicroseconds(2);
        // Sending a 10 microsecond HIGH pulse to trigger the ultrasonic burst
        digitalWrite(trigPin, HIGH);
        delayMicroseconds(10);
        // Stopping the trigger pulse
        digitalWrite(trigPin, LOW);
        // Measuring the time (in microseconds) for the echo pin to go HIGH
        duration = pulseIn(echoPin, HIGH);
        // Converting time into distance (speed of sound = 0.034 cm/microsec, divide by 2 for round trip)
        distance = duration * 0.034 / 2;
        // Moving the cursor to the top-left of the LCD
        lcd.setCursor(0, 0);
        // Displaying the measured distance
        lcd.print("Distance: ");
        lcd.print(distance);
        // Printing extra spaces clear old characters on the LCD
        lcd.print("cm  ");  
        // Moving to the second line of the LCD
        lcd.setCursor(0, 1);
        
        // If the measured distance is less than 10 cm, we show "Object detected"
        if (distance < 10) {
            lcd.print("Object detected");
        } 
        // Else, show "No object"
        else {
            lcd.print("No object");
        }

        // Short delay before going to the next reading to prevent flicker
        delay(500);
        }
      </code></pre>
    </section>

    <!-- Circuit Operation -->
    <section>
      <h2>Circuit Operation</h2>
      <figure>
        <img src="a4_gif.mp4"/>
        <figcaption>
          The ultrasonic sensor detects the distance of nearby objects, and the LCD dynamically updates to display real-time 
          distance readings and motion status. When an object is within 10 cm, the message "Object detected" appears. 
          Otherwise it shows "No object."
        </figcaption>
      </figure>
    </section>

    <!-- Additional Questions -->
    <section>
      <h2>Answers to Additional Questions</h2>
      <h3>1. Draw a graph with the x-axis as time and the y-axis as voltage at pin 9 with respect to ground.</h3>
      <figure>
        <img src="a4_graph.jpg"/>
      </figure>  
      <h3>2.Your input device is slightly broken, leading it to give us 
        an erroneous reading 1% of the time. How can we address this? Answer in (pseudo)code.</h3>
      <pre><code>
        FUNCTION readSensorReliable():
            readings // this is an empty list

            FOR i FROM 1 TO 5 DO
                // get a reading from the sensor
                value = readSensor() 
                // check if reading is within expected range              
                IF isValid(value) THEN             
                    append value TO readings
                WAIT 10 milliseconds
            END FOR
            // if all readings are invalid
            IF length(readings) = 0 THEN 
                // use the last known good reading          
                RETURN lastValidValue             
            ELSE
                // compute average of valid readings
                reliableValue // average(readings)  
                // store it for next time
                lastValidValue = reliableValue     
                RETURN reliableValue
            END IF
        END FUNCTION

        FUNCTION isValid(value):
            RETURN (value ≥ 0 AND value ≤ MAX_RANGE)
        END FUNCTION
      </code></pre>
      <h3>3.Your input device is slightly noisy, leading the measurement to randomly deviate from the true measurement 
        up or down by 10%. How can we address this? Answer in (pseudo)code.</h3>
      <pre><code>
        FUNCTION readSensorSmoothed():
            readings // empty list

            // Take multiple readings to reduce the effect of random noise
            FOR i FROM 1 TO 10 DO
                // read current sensor value
                value = readSensor()             
                append value TO readings
                WAIT 10 milliseconds
            END FOR

            // Compute the average to smooth out random plus/minuc 10% variations
            smoothedValue = average(readings)

            RETURN smoothedValue
        END FUNCTION
      </code></pre>
    </section>
  </body>
  </body>
</html>
